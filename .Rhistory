labs (x = "", y = "Porcentagem de Posts") +
theme(text = element_text(size=6), axis.text.x = element_text(angle=45, hjust=1)) +
scale_fill_manual("Polaridade", values = c("Positivo" = ggplotColours(n=3)[2], "Negativo" = ggplotColours(n=3)[1], "Neutro" = ggplotColours(n=3)[3]))
df_datas %>%
group_by(datas, polaridades) %>%
summarise (n = n()) %>%
mutate(freq = 100*n / sum(n)) %>%
ggplot() +
geom_bar(position = "stack", stat = "identity", aes(x = datas, y = freq, fill = polaridades)) +
labs (title = "") +
labs (x = "", y = "Porcentagem de Posts") +
theme(text = element_text(size=6), axis.text.x = element_text(angle=45, hjust=1)) +
scale_fill_manual("Polaridade", values = c("Positivo" = ggplotColours(n=3)[2], "Negativo" = ggplotColours(n=3)[1], "Neutro" = ggplotColours(n=3)[3]))
p1 <- df_datas %>%
group_by(datas, polaridades) %>%
summarise (n = n()) %>%
mutate(freq = 100*n / sum(n)) %>%
ggplot() +
geom_bar(position = "stack", stat = "identity", aes(x = datas, y = freq, fill = polaridades)) +
labs (title = "") +
labs (x = "", y = "Porcentagem de Posts") +
theme(text = element_text(size=6), axis.text.x = element_text(angle=45, hjust=1)) +
scale_fill_manual("Polaridade", values = c("Positivo" = ggplotColours(n=3)[2], "Negativo" = ggplotColours(n=3)[1], "Neutro" = ggplotColours(n=3)[3]))
df_datas %>%
group_by(datas) %>%
summarise (n = n()) %>%
mutate(total = sum(n))
df_datas %>%
group_by(datas) %>%
summarise (n = n())
df_datas %>%
group_by(datas) %>%
summarise (n = n()) %>%
ggplot() +
geom_line(position = "stack", stat = "identity", aes(x = datas, y = n))
df_datas %>%
group_by(datas) %>%
summarise (n = n()) %>%
ggplot() +
geom_line(stat = "identity", aes(x = datas, y = n, group=1))
df_datas %>%
group_by(datas) %>%
summarise (n = n()) %>%
ggplot() +
geom_line(stat = "identity", aes(x = datas, y = n, group=1)) +
labs (title = "") +
labs (x = "", y = "Número de Posts") +
theme(text = element_text(size=6), axis.text.x = element_text(angle=45, hjust=1))
df_datas %>%
group_by(datas, polaridades) %>%
summarise (n = n()) %>%
mutate(freq = 100*n / sum(n))
df_datas %>%
group_by(datas, polaridades) %>%
summarise (n = n()) %>%
mutate(freq = 100*n / sum(n)) %>%
ungroup() %>%
group_by(datas) %>%
summarise (total = n())
df_datas %>%
group_by(datas, polaridades) %>%
summarise (n = n()) %>%
mutate(freq = 100*n / sum(n)) %>%
group_by(datas) %>%
summarise (total = n())
df_datas %>%
group_by(datas, polaridades) %>%
summarise (n = n()) %>%
mutate(freq = 100*n / sum(n)) %>%
summarise (total = n())
df_datas %>%
group_by(datas, polaridades) %>%
summarise (n = n()) %>%
mutate(freq = 100*n / sum(n), total=n())
df_datas %>%
group_by(datas) %>%
summarise (total = n())
p1 <- df_datas %>%
group_by(datas, polaridades) %>%
summarise (n = n()) %>%
mutate(freq = 100*n / sum(n)) %>%
ggplot() +
geom_bar(position = "stack", stat = "identity", aes(x = datas, y = freq, fill = polaridades)) +
labs (title = "") +
labs (x = "", y = "Porcentagem de Posts") +
theme(text = element_text(size=6), axis.text.x = element_text(angle=45, hjust=1)) +
scale_fill_manual("Polaridade", values = c("Positivo" = ggplotColours(n=3)[2], "Negativo" = ggplotColours(n=3)[1], "Neutro" = ggplotColours(n=3)[3]))
p2 <- df_datas %>%
group_by(datas) %>%
summarise (n = n()) %>%
ggplot() +
geom_line(stat = "identity", aes(x = datas, y = n, group=1)) +
labs (title = "") +
labs (x = "", y = "Número de Posts") +
theme(text = element_text(size=6), axis.text.x = element_text(angle=45, hjust=1))
p1
p1 + p2 + scale_y_continuous(sec.axis=2500)
p1 + p2
df2 <- df_datas %>%
group_by(datas) %>%
summarise (n = n())
df2
p1
p1 + ggplot(df2) +
geom_line(stat = "identity", aes(x = datas, y = n, group=1)) +
labs (title = "") +
labs (x = "", y = "Número de Posts") +
theme(text = element_text(size=6), axis.text.x = element_text(angle=45, hjust=1))
p1 + ggplot(df2) +
geom_line(stat = "identity", aes(x = datas, y = n, group=1))
p1 + geom_line(stat = "identity", aes(x = df2$datas, y = df2$n, group=1))
p1 + geom_line(stat = "identity", aes(x = df2$datas, y = df2$n))
p1 <- df_datas %>%
group_by(datas, polaridades) %>%
summarise (n = n()) %>%
mutate(freq = 100*n / sum(n)) %>%
ggplot() +
geom_bar(position = "stack", stat = "identity", aes(x = datas, y = freq, fill = polaridades)) +
labs (title = "") +
labs (x = "", y = "Porcentagem de Posts") +
theme(text = element_text(size=6), axis.text.x = element_text(angle=45, hjust=1)) +
scale_fill_manual("Polaridade", values = c("Positivo" = ggplotColours(n=3)[2], "Negativo" = ggplotColours(n=3)[1], "Neutro" = ggplotColours(n=3)[3]))
p2 <- df_datas %>%
group_by(datas) %>%
summarise (n = n()) %>%
ggplot() +
geom_line(stat = "identity", aes(x = datas, y = n, group=1)) +
labs (title = "") +
labs (x = "", y = "Número de Posts") +
theme(text = element_text(size=6), axis.text.x = element_text(angle=45, hjust=1))
p1
p2
df_datas %>%
group_by(datas) %>%
summarise (n = n())
df_datas %>%
group_by(datas, polaridades) %>%
summarise (n = n()) %>%
mutate(freq = 100*n / sum(n))
df2
df_datas %>%
group_by(datas, polaridades) %>%
summarise (n = n()) %>%
mutate(freq = 100*n / sum(n)) %>%
ggplot() +
geom_bar(position = "stack", stat = "identity", aes(x = datas, y = freq, fill = polaridades)) +
labs (title = "") +
labs (x = "", y = "Porcentagem de Posts") +
theme(text = element_text(size=6), axis.text.x = element_text(angle=45, hjust=1)) +
geom_line(aes(x = df2$datas, y = df2$n))
df_datas %>%
group_by(datas, polaridades) %>%
summarise (n = n()) %>%
mutate(freq = 100*n / sum(n)) %>%
ggplot() +
geom_bar(position = "stack", stat = "identity", aes(x = datas, y = freq, fill = polaridades)) +
labs (title = "") +
labs (x = "", y = "Porcentagem de Posts") +
theme(text = element_text(size=6), axis.text.x = element_text(angle=45, hjust=1)) +
geom_line(data = df2, aes(x = datas, y = n))
df_datas %>%
group_by(datas, polaridades) %>%
summarise (n = n()) %>%
mutate(freq = 100*n / sum(n)) %>%
ggplot() +
geom_bar(position = "stack", stat = "identity", aes(x = datas, y = freq, fill = polaridades)) +
labs (title = "") +
labs (x = "", y = "Porcentagem de Posts") +
theme(text = element_text(size=6), axis.text.x = element_text(angle=45, hjust=1)) +
geom_line(data = df2, aes(x = datas, y = n), position = "dodge")
df_datas %>%
group_by(datas, polaridades) %>%
summarise (n = n()) %>%
mutate(freq = 100*n / sum(n)) %>%
ggplot() +
geom_bar(position = "stack", stat = "identity", aes(x = datas, y = freq, fill = polaridades)) +
labs (title = "") +
labs (x = "", y = "Porcentagem de Posts") +
theme(text = element_text(size=6), axis.text.x = element_text(angle=45, hjust=1)) +
geom_line(data = df2, aes(x = datas, y = n, group=1), position = "dodge")
df_datas %>%
group_by(datas, polaridades) %>%
summarise (n = n()) %>%
mutate(freq = 100*n / sum(n)) %>%
ggplot() +
geom_bar(position = "stack", stat = "identity", aes(x = datas, y = freq, fill = polaridades)) +
labs (title = "") +
labs (x = "", y = "Porcentagem de Posts") +
theme(text = element_text(size=6), axis.text.x = element_text(angle=45, hjust=1)) +
geom_line(data = df2, aes(x = datas, y = n, group=1), position = "identity")
??sec_axis
df_datas %>%
group_by(datas, polaridades) %>%
summarise (n = n()) %>%
mutate(freq = 100*n / sum(n)) %>%
ggplot() +
geom_bar(position = "stack", stat = "identity", aes(x = datas, y = freq, fill = polaridades)) +
labs (title = "") +
labs (x = "", y = "Porcentagem de Posts") +
theme(text = element_text(size=6), axis.text.x = element_text(angle=45, hjust=1)) +
geom_line(data = df2, aes(x = datas, y = n, group=1), position = "identity")+
scale_y_continuous(sec.axis = 2500)
df_datas %>%
group_by(datas, polaridades) %>%
summarise (n = n()) %>%
mutate(freq = 100*n / sum(n)) %>%
ggplot() +
geom_bar(position = "stack", stat = "identity", aes(x = datas, y = freq, fill = polaridades)) +
labs (title = "") +
labs (x = "", y = "Porcentagem de Posts") +
theme(text = element_text(size=6), axis.text.x = element_text(angle=45, hjust=1)) +
geom_line(data = df2, aes(x = datas, y = n, group=1), position = "identity")+
scale_y_continuous(sec_axis = 2500)
df_datas %>%
group_by(datas, polaridades) %>%
summarise (n = n()) %>%
mutate(freq = 100*n / sum(n)) %>%
ggplot() +
geom_bar(position = "stack", stat = "identity", aes(x = datas, y = freq, fill = polaridades)) +
labs (title = "") +
labs (x = "", y = "Porcentagem de Posts") +
theme(text = element_text(size=6), axis.text.x = element_text(angle=45, hjust=1)) +
geom_line(data = df2, aes(x = datas, y = n, group=1), position = "identity")+
scale_y_continuous(sec.axis = sec_axis(~.+2500))
df_datas %>%
group_by(datas, polaridades) %>%
summarise (n = n()) %>%
mutate(freq = 100*n / sum(n)) %>%
ggplot() +
geom_bar(position = "stack", stat = "identity", aes(x = datas, y = freq, fill = polaridades)) +
scale_y_continuous(sec.axis = sec_axis(~.2500))+
labs (title = "") +
labs (x = "", y = "Porcentagem de Posts") +
theme(text = element_text(size=6), axis.text.x = element_text(angle=45, hjust=1)) +
geom_line(data = df2, aes(x = datas, y = n, group=1), position = "identity")
p1 <- df_datas %>%
group_by(datas, polaridades) %>%
summarise (n = n()) %>%
mutate(freq = 100*n / sum(n)) %>%
ggplot() +
geom_bar(position = "stack", stat = "identity", aes(x = datas, y = freq, fill = polaridades)) +
labs (title = "") +
labs (x = "", y = "Porcentagem de Posts") +
theme(text = element_text(size=6), axis.text.x = element_text(angle=45, hjust=1)) +
scale_fill_manual("Polaridade", values = c("Positivo" = ggplotColours(n=3)[2], "Negativo" = ggplotColours(n=3)[1], "Neutro" = ggplotColours(n=3)[3]))
p2 <- df_datas %>%
group_by(datas) %>%
summarise (n = n()) %>%
ggplot() +
geom_line(stat = "identity", aes(x = datas, y = n, group=1)) +
labs (title = "") +
labs (x = "", y = "Número de Posts") +
theme(text = element_text(size=6), axis.text.x = element_text(angle=45, hjust=1))
p1
p2
runApp()
df_datas %>%
group_by(datas, polaridades) %>%
summarise (n = n()) %>%
mutate(freq = 100*n / sum(n)) %>%
ggplot() +
geom_bar(position = "stack", stat = "identity", aes(x = datas, y = freq, fill = polaridades)) +
labs (title = "") +
labs (x = "", y = "Porcentagem de Posts") +
theme(text = element_text(size=6), axis.text.x = element_text(angle=45, hjust=1)) +
scale_fill_manual("Polaridade", values = c("Positivo" = ggplotColours(n=3)[2], "Negativo" = ggplotColours(n=3)[1], "Neutro" = ggplotColours(n=3)[3])) +
geom_text( aes (x = datas, y = freq, label = as.numeric(freq) ) , vjust = 0, hjust = 0, size = 2 )
df_datas %>%
group_by(datas, polaridades) %>%
summarise (n = n()) %>%
mutate(freq = 100*n / sum(n)) %>%
ggplot() +
geom_bar(position = "stack", stat = "identity", aes(x = datas, y = freq, fill = polaridades)) +
labs (title = "") +
labs (x = "", y = "Porcentagem de Posts") +
theme(text = element_text(size=6), axis.text.x = element_text(angle=45, hjust=1)) +
scale_fill_manual("Polaridade", values = c("Positivo" = ggplotColours(n=3)[2], "Negativo" = ggplotColours(n=3)[1], "Neutro" = ggplotColours(n=3)[3])) +
geom_text( aes (x = datas, y = signif(freq,2), label = as.numeric(freq) ) , vjust = 0, hjust = 0, size = 2 )
df_datas %>%
group_by(datas, polaridades) %>%
summarise (n = n()) %>%
mutate(freq = 100*n / sum(n)) %>%
ggplot() +
geom_bar(position = "stack", stat = "identity", aes(x = datas, y = freq, fill = polaridades)) +
labs (title = "") +
labs (x = "", y = "Porcentagem de Posts") +
theme(text = element_text(size=6), axis.text.x = element_text(angle=45, hjust=1)) +
scale_fill_manual("Polaridade", values = c("Positivo" = ggplotColours(n=3)[2], "Negativo" = ggplotColours(n=3)[1], "Neutro" = ggplotColours(n=3)[3])) +
geom_text( aes (x = datas, y = signif(freq,2), label = signif(as.numeric(freq),2) ) , vjust = 0, hjust = 0, size = 2 )
position_label <- rep(NA,length(polaridades))
position_label
position_label[which(toupper(polaridades) == "POSITIVO")] <- 0.03;
position_label[which(toupper(polaridades) == "NEGATIVO")] <- 0.97;
getPositionY <- function(test){
labelpos <- array(NA,length(test$Polaridade))
labelpos[ which(test$Polaridade == "POSITIVO") ] <- "0.02"
labelpos[ which(test$Polaridade == "NEGATIVO") ] <- "0.98"
datasb <- test$Data[which(test$Polaridade == "NEUTRO")];
posvarb <- which(test$Polaridade == "NEUTRO");
for(i in 1:length(datasb)){
datasb_ <- datasb[i];
positionobsb <- which(test$Data == datasb_ & test$Polaridade == "POSITIVO")
obsb <- ifelse(length(positionobsb) > 0, test$freq[positionobsb], 0);
labelpos[posvarb[i]] <- obsb + 0.02
}
return(as.numeric(labelpos))
}
getPositionY <- function(test){
labelpos <- array(NA,length(test$polaridades))
labelpos[ which(test$polaridades == "POSITIVO") ] <- "0.02"
labelpos[ which(test$polaridades == "NEGATIVO") ] <- "0.98"
datasb <- test$Data[which(test$polaridades == "NEUTRO")];
posvarb <- which(test$polaridades == "NEUTRO");
for(i in 1:length(datasb)){
datasb_ <- datasb[i];
positionobsb <- which(test$Data == datasb_ & test$polaridades == "POSITIVO")
obsb <- ifelse(length(positionobsb) > 0, test$freq[positionobsb], 0);
labelpos[posvarb[i]] <- obsb + 0.02
}
return(as.numeric(labelpos))
}
getPositionY(df_datas)
getPositionY <- function(test){
labelpos <- array(NA,length(test$polaridades))
labelpos[ which(test$polaridades == "POSITIVO") ] <- "0.02"
labelpos[ which(test$polaridades == "NEGATIVO") ] <- "0.98"
datasb <- test$datas[which(test$polaridades == "NEUTRO")];
posvarb <- which(test$polaridades == "NEUTRO");
for(i in 1:length(datasb)){
datasb_ <- datasb[i];
positionobsb <- which(test$datas == datasb_ & test$polaridades == "POSITIVO")
obsb <- ifelse(length(positionobsb) > 0, test$freq[positionobsb], 0);
labelpos[posvarb[i]] <- obsb + 0.02
}
return(as.numeric(labelpos))
}
getPositionY(df_datas)
test <- df_datas
labelpos <- array(NA,length(test$polaridades))
labelpos[ which(test$polaridades == "POSITIVO") ] <- "0.02"
labelpos[ which(test$polaridades == "NEGATIVO") ] <- "0.98"
datasb <- test$datas[which(test$polaridades == "NEUTRO")];
posvarb <- which(test$polaridades == "NEUTRO");
posvarb
datasb
getPositionY <- function(test){
test$polaridades <- toupper(test$polaridades)
labelpos <- array(NA,length(test$polaridades))
labelpos[ which(test$polaridades == "POSITIVO") ] <- "0.02"
labelpos[ which(test$polaridades == "NEGATIVO") ] <- "0.98"
datasb <- test$datas[which(test$polaridades == "NEUTRO")];
posvarb <- which(test$polaridades == "NEUTRO");
for(i in 1:length(datasb)){
datasb_ <- datasb[i];
positionobsb <- which(test$datas == datasb_ & test$polaridades == "POSITIVO")
obsb <- ifelse(length(positionobsb) > 0, test$freq[positionobsb], 0);
labelpos[posvarb[i]] <- obsb + 0.02
}
return(as.numeric(labelpos))
}
getPositionY(df_datas)
test <- df_datas
test$polaridades <- toupper(test$polaridades)
labelpos <- array(NA,length(test$polaridades))
labelpos[ which(test$polaridades == "POSITIVO") ] <- "0.02"
labelpos[ which(test$polaridades == "NEGATIVO") ] <- "0.98"
datasb <- test$datas[which(test$polaridades == "NEUTRO")];
posvarb <- which(test$polaridades == "NEUTRO");
posvarb
length(datasb)
i<-1
length(test$polaridades)
datasb_ <- datasb[i];
positionobsb <- which(test$datas == datasb_ & test$polaridades == "POSITIVO")
obsb <- ifelse(length(positionobsb) > 0, test$freq[positionobsb], 0);
datasb_
positionobsb
length(positionobsb)
test$freq[positionobsb]
names(test)
getPositionY <- function(test){
test$polaridades <- toupper(test$polaridades)
labelpos <- array(NA,length(test$polaridades))
labelpos[ which(test$polaridades == "POSITIVO") ] <- "0.02"
labelpos[ which(test$polaridades == "NEGATIVO") ] <- "0.98"
datasb <- test$datas[which(test$polaridades == "NEUTRO")];
posvarb <- which(test$polaridades == "NEUTRO");
for(i in 1:length(datasb)){
datasb_ <- datasb[i];
positionobsb <- which(test$datas == datasb_ & test$polaridades == "POSITIVO")
obsb <- ifelse(length(positionobsb) > 0, test$freq[positionobsb], 0);
labelpos[posvarb[i]] <- obsb + 0.02
}
return(as.numeric(labelpos))
}
df_datas %>%
group_by(datas, polaridades) %>%
summarise (n = n()) %>%
mutate(freq = 100*n / sum(n)) %>%
ggplot() +
geom_bar(position = "stack", stat = "identity", aes(x = datas, y = freq, fill = polaridades)) +
labs (title = "") +
labs (x = "", y = "Porcentagem de Posts") +
theme(text = element_text(size=6), axis.text.x = element_text(angle=45, hjust=1)) +
scale_fill_manual("Polaridade", values = c("Positivo" = ggplotColours(n=3)[2], "Negativo" = ggplotColours(n=3)[1], "Neutro" = ggplotColours(n=3)[3])) +
geom_text(size = 2, col = "white", aes(x = datas, y = getPositionY(df_datas), label = paste(as.character(100*signif(df_datas$freq,1)),"%",sep="")));
df_datas %>%
group_by(datas, polaridades) %>%
summarise (n = n()) %>%
mutate(freq = n / sum(n)) %>%
ggplot() +
geom_bar(position = "stack", stat = "identity", aes(x = datas, y = 100*freq, fill = polaridades)) +
labs (title = "") +
labs (x = "", y = "Porcentagem de Posts") +
theme(text = element_text(size=6), axis.text.x = element_text(angle=45, hjust=1)) +
scale_fill_manual("Polaridade", values = c("Positivo" = ggplotColours(n=3)[2], "Negativo" = ggplotColours(n=3)[1], "Neutro" = ggplotColours(n=3)[3])) +
geom_text(size = 2, col = "white", aes(x = datas, y = getPositionY(df_datas), label = paste(as.character(100*signif(df_datas$freq,1)),"%",sep="")));
df_datas %>%
group_by(datas, polaridades) %>%
summarise (n = n()) %>%
mutate(freq = n / sum(n)) %>%
ggplot() +
geom_bar(position = "stack", stat = "identity", aes(x = datas, y = 100*freq, fill = polaridades)) +
labs (title = "") +
labs (x = "", y = "Porcentagem de Posts") +
theme(text = element_text(size=6), axis.text.x = element_text(angle=45, hjust=1)) +
scale_fill_manual("Polaridade", values = c("Positivo" = ggplotColours(n=3)[2], "Negativo" = ggplotColours(n=3)[1], "Neutro" = ggplotColours(n=3)[3]))
?geom_text
getPositionY <- function(test,freq){
test$polaridades <- toupper(test$polaridades)
labelpos <- array(NA,length(test$polaridades))
labelpos[ which(test$polaridades == "POSITIVO") ] <- "0.02"
labelpos[ which(test$polaridades == "NEGATIVO") ] <- "0.98"
datasb <- test$datas[which(test$polaridades == "NEUTRO")];
posvarb <- which(test$polaridades == "NEUTRO");
for(i in 1:length(datasb)){
datasb_ <- datasb[i];
positionobsb <- which(test$datas == datasb_ & test$polaridades == "POSITIVO")
obsb <- ifelse(length(positionobsb) > 0, freq[positionobsb], 0);
labelpos[posvarb[i]] <- obsb + 0.02
}
return(as.numeric(labelpos))
}
df_datas %>%
group_by(datas, polaridades) %>%
summarise (n = n()) %>%
mutate(freq = n / sum(n)) %>%
ggplot() +
geom_bar(position = "stack", stat = "identity", aes(x = datas, y = 100*freq, fill = polaridades)) +
labs (title = "") +
labs (x = "", y = "Porcentagem de Posts") +
theme(text = element_text(size=6), axis.text.x = element_text(angle=45, hjust=1)) +
scale_fill_manual("Polaridade", values = c("Positivo" = ggplotColours(n=3)[2], "Negativo" = ggplotColours(n=3)[1], "Neutro" = ggplotColours(n=3)[3])) +
geom_text(size = 2, col = "white", aes(x = datas, y = getPositionY(df_datas, freq), label = paste(as.character(100*signif(df_datas$freq,1)),"%",sep="")));
df_datas %>%
group_by(datas, polaridades) %>%
summarise (n = n()) %>%
mutate(freq = n / sum(n)) %>%
ggplot() +
geom_bar(position = "stack", stat = "identity", aes(x = datas, y = 100*freq, fill = polaridades)) +
labs (title = "") +
labs (x = "", y = "Porcentagem de Posts") +
theme(text = element_text(size=6), axis.text.x = element_text(angle=45, hjust=1)) +
scale_fill_manual("Polaridade", values = c("Positivo" = ggplotColours(n=3)[2], "Negativo" = ggplotColours(n=3)[1], "Neutro" = ggplotColours(n=3)[3])) +
geom_text(size = 2, col = "white", aes(x = datas, y = getPositionY(df_datas, freq), label = paste(as.character(100*signif(freq,1)),"%",sep="")));
df_datas %>%
group_by(datas, polaridades) %>%
summarise (n = n()) %>%
mutate(freq = n / sum(n)) %>%
ggplot() +
geom_bar(position = "stack", stat = "identity", aes(x = datas, y = 100*freq, fill = polaridades)) +
labs (title = "") +
labs (x = "", y = "Porcentagem de Posts") +
theme(text = element_text(size=6), axis.text.x = element_text(angle=45, hjust=1)) +
scale_fill_manual("Polaridade", values = c("Positivo" = ggplotColours(n=3)[2], "Negativo" = ggplotColours(n=3)[1], "Neutro" = ggplotColours(n=3)[3])) +
geom_text(size = 2, col = "white", aes(x = datas, y = getPositionY(df_datas, df_datas$freq), label = paste(as.character(100*signif(df_datas$freq,1)),"%",sep="")));
df_datas$freq
df_datas
df_datas %>%
group_by(datas, polaridades) %>%
summarise (n = n()) %>%
mutate(freq = n / sum(n)) %>%
ggplot() +
geom_bar(position = "stack", stat = "identity", aes(x = datas, y = 100*freq, fill = polaridades)) +
labs (title = "") +
labs (x = "", y = "Porcentagem de Posts") +
theme(text = element_text(size=6), axis.text.x = element_text(angle=45, hjust=1)) +
scale_fill_manual("Polaridade", values = c("Positivo" = ggplotColours(n=3)[2], "Negativo" = ggplotColours(n=3)[1], "Neutro" = ggplotColours(n=3)[3])) +
geom_text(size = 2, col = "white", aes(x = datas, y = getPositionY(df_datas, freq), label = paste(as.character(100*signif(freq,1)),"%",sep="")));
p1 <- df_datas %>%
group_by(datas, polaridades) %>%
summarise (n = n()) %>%
mutate(freq = n / sum(n)) %>%
ggplot() +
geom_bar(position = "stack", stat = "identity", aes(x = datas, y = 100*freq, fill = polaridades)) +
labs (title = "") +
labs (x = "", y = "Porcentagem de Posts") +
theme(text = element_text(size=6), axis.text.x = element_text(angle=45, hjust=1)) +
scale_fill_manual("Polaridade", values = c("Positivo" = ggplotColours(n=3)[2], "Negativo" = ggplotColours(n=3)[1], "Neutro" = ggplotColours(n=3)[3]))
p1 + geom_text(data = df_datas, size = 2, col = "white", aes(x = datas, y = getPositionY(df_datas, freq), label = paste(as.character(100*signif(freq,1)),"%",sep="")));
p1 + geom_text(data = df_datas, size = 2, col = "white", aes(x = datas, y = getPositionY(df_datas, df_datas$freq), label = paste(as.character(100*signif(freq,1)),"%",sep="")));
df_datas %>%
group_by(datas, polaridades) %>%
summarise (n = n()) %>%
mutate(freq = n / sum(n)) %>%
ggplot() +
geom_bar(position = "stack", stat = "identity", aes(x = datas, y = 100*freq, fill = polaridades)) +
labs (title = "") +
labs (x = "", y = "Porcentagem de Posts") +
theme(text = element_text(size=6), axis.text.x = element_text(angle=45, hjust=1)) +
scale_fill_manual("Polaridade", values = c("Positivo" = ggplotColours(n=3)[2], "Negativo" = ggplotColours(n=3)[1], "Neutro" = ggplotColours(n=3)[3]))
runApp()
